# ChunkPreClaimEvent

一个纯前端的“圈地/领地扩张”可视化小工具：左侧是网格与统计，右侧可直接编辑 `canClaim(state, cell)` 规则并应用。

## 运行

两种方式都可以：

1) 直接双击打开 `index.html`（推荐给纯本地使用）。
2) 启动静态服务器后访问（推荐便于分享）：

```bash
python -m http.server 8000
```

浏览器访问：`http://localhost:8000/index.html`

## 目录结构

- `index.html`：页面结构（不含内联 CSS/JS）。
- `styles.css`：样式。
- `src/main.js`：应用入口（事件绑定、状态初始化、启动渲染）。
- `src/render.js`：渲染与可圈地集合计算。
- `src/rules.js`：默认圈地规则（内置模块开关都在这里判定）。
- `src/metrics.js`：周长/直径/外接方/内接方等指标计算。
- `src/utils.js`：坐标与邻接工具。
- `src/state.js`：默认状态结构与规则开关默认值。
- `index.legacy.html`：旧的单文件版本（保留作参考）。

## 内置规则模块（开关）

这些开关只作用于“默认逻辑”（`src/rules.js:defaultCanClaim`）。如果你在右侧编辑器里应用了自定义 `canClaim`，需要你自己在代码里读取 `state.rules` 并实现对应限制。

- `扩张需≥2邻接`：新增格子必须与至少 2 个已圈地格子 4 邻接。
- `限制长臂 (L=)`：只在“单邻接扩张”时，限制新端点形成的细臂长度。
- `限制 周长/面积`：限制 `P/A` 上限（细长形状更容易超标）。
- `限制端点数`：限制 4 邻接度为 1 的端点数量。
- `禁止空心圈地`：若新增导致出现与外部不连通的“洞”（4 邻接定义）则拒绝。
- `限制外接方填充率`：限制 `A/L²` 下限（`L` 为轴对齐最小外接正方形边长）。
- `限制最大内接方占比`：限制 `Lin²/A` 下限（`Lin` 为最大“实心填满”的轴对齐正方形边长）。
