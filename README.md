# ChunkPreClaimEvent

一个纯前端的“圈地/领地扩张”可视化小工具：左侧是大网格交互区，右侧是配置/规则与消息面板。

## 运行

两种方式都可以：

1) 直接双击打开 `index.html`（纯本地使用）。
2) 启动静态服务器后访问（便于分享）：

```bash
python -m http.server 8000
```

浏览器访问：`http://localhost:8000/index.html`

## 目录结构

- `index.html`：页面结构（不含内联 CSS/JS）。
- `styles.css`：样式。
- `src/main.js`：应用入口（事件绑定、状态初始化、启动渲染）。
- `src/render.js`：渲染与可圈地集合计算。
- `src/rules.js`：默认圈地规则（内置模块开关都在这里判定）。
- `src/metrics.js`：周长/直径/外接方/内接方等指标计算。
- `src/utils.js`：坐标与邻接工具。
- `src/state.js`：默认状态结构与规则开关默认值。

## 内置规则模块（开关）

这些开关只作用于“默认逻辑”（`src/rules.js:defaultCanClaim`）。

- `双邻接门槛（B）`：新增格子必须与至少 2 个已圈地格子四邻接。
- `邻域支撑门槛（J：8/24）`：目标格周围 1圈(8格)已圈地>m 且 1+2圈(24格)已圈地>n 才允许扩张（两者需同时满足）。
- `长臂抑制（C）`：只在“单邻接扩张”时限制细臂长度（`armLen ≤ L`）。
- `形状紧凑度上限（D：P/A）`：限制 `P/A` 上限（细长形状更容易超标）。
- `直径上限（I：D）`：限制领地内最远两点距离（4 邻接步数近似）。
- `端点数上限（E）`：限制 4 邻接度为 1 的端点数量。
- `禁止空心（F）`：禁止新增与外部不连通的“洞”（4 邻接定义）；若当前已存在洞，则不允许让洞变大（用于逐步填洞）。
- `外接方填充率下限（G：A/L²）`：限制 `A/L²` 下限（`L` 为轴对齐最小外接正方形边长）。
- `内接实心方占比下限（H：Lin²/A）`：限制 `Lin²/A` 下限（`Lin` 为最大“实心填满”的轴对齐正方形边长）。

## 说明

- 已移除“自定义 canClaim 编辑器/弹窗”等旧逻辑；如需自定义规则，请直接改 `src/rules.js`。
